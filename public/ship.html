<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Charlie's Dropship Store</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
<style>
:root{--accent:#0ea5a4;--muted:#6b7280}
body{font-family:Inter,system-ui,Arial;margin:0;background:#f3f4f6;color:#111}
header{background:#fff;padding:12px 20px;border-bottom:1px solid #e6e6e6;display:flex;align-items:center;justify-content:space-between}
.brand{font-weight:700;color:var(--accent)}
.main{max-width:1100px;margin:20px auto;display:grid;grid-template-columns:1fr 320px;gap:20px;padding:0 16px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px}
.card{background:#fff;padding:12px;border-radius:12px;box-shadow:0 2px 8px rgba(10,10,10,0.04)}
.card img{width:100%;height:160px;object-fit:cover;border-radius:8px}
.card h4{margin:10px 0 6px}
.price{font-weight:700}
.cart-btn{background:var(--accent);color:#fff;border:0;padding:8px 12px;border-radius:8px;cursor:pointer}
.sidebar{position:sticky;top:20px}
.cart{background:#fff;padding:12px;border-radius:12px}
.cart h3{margin:0 0 8px}
.cart-list{max-height:360px;overflow:auto}
.cart-item{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px dashed #eee}
.small{font-size:13px;color:var(--muted)}
.modal{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;padding:20px;z-index:999}
.modal.show{display:flex}
.modal-card{width:520px;max-width:100%;background:#fff;padding:18px;border-radius:12px}
input,select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #e6e6e6;margin-top:6px}
.row{display:flex;gap:8px}
.row > *{flex:1}
.success{display:none;text-align:center;padding:40px}
.qty-btn{padding:2px 6px;border:none;background:#ddd;border-radius:4px;cursor:pointer}
.remove-btn{padding:2px 6px;border:none;background:#ef4444;color:#fff;border-radius:4px;cursor:pointer}
.admin-panel{background:#fff;padding:12px;margin-bottom:20px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.05);display:none}
.admin-panel h3{margin-top:0}
.admin-panel label{display:block;margin-top:6px}
#adminStatus{margin-top:6px;font-size:13px;color:var(--accent);}
#adminAccessBtn{position:fixed;bottom:20px;right:20px;padding:10px 14px;border-radius:50%;background:var(--accent);color:#fff;border:none;cursor:pointer;z-index:999}
@media(max-width:900px){.main{grid-template-columns:1fr} .sidebar{position:relative}}
</style>

<!-- Stripe SDK -->
<script src="https://js.stripe.com/v3/"></script>
<!-- PayPal SDK -->
<script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&currency=USD"></script>
</head>
<body>

<header>
  <div class="brand">My Dropship Store</div>
  <div>
    <button id="cartToggle" class="cart-btn">Cart (<span id="cartCount">0</span>)</button>
  </div>
</header>

<!-- Admin Icon -->
<button id="adminAccessBtn" title="Admin Panel">⚙️</button>

<div class="main">
  <section>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanelWrapper">
      <h3>Admin: Add Product</h3>
      <label>AliExpress URL
        <input id="adminAliLink" placeholder="Paste AliExpress product URL">
        <button type="button" id="fetchAli">Fetch Info</button>
      </label>
      <label>Title<input id="adminTitle"></label>
      <label>Price ($)<input id="adminPrice" type="number"></label>
      <label>Supplier Cost ($)<input id="adminCost" type="number"></label>
      <label>SKU<input id="adminSKU"></label>
      <label>Image URL<input id="adminImg"></label>
      <button id="addProductBtn" class="cart-btn" style="margin-top:8px;">Add Product</button>
      <div id="adminStatus"></div>
    </div>

    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
      <h2 style="margin:0">Products</h2>
      <div class="small">Hand-picked niche products</div>
    </div>

    <div id="upsells" class="card small" style="margin-bottom:16px">
      <strong>Recommended for you</strong>
      <div id="upsellList" style="display:flex;gap:8px;margin-top:8px"></div>
    </div>

    <div id="productsGrid" class="grid"></div>
  </section>

  <aside class="sidebar">
    <div class="cart card" id="cartPanel">
      <h3>Your Cart</h3>
      <div class="cart-list" id="cartList"></div>
      <div class="total" style="display:flex;justify-content:space-between;margin-top:12px;font-weight:700">
        <div>Total</div><div id="cartTotal">$0.00</div>
      </div>
      <div style="margin-top:12px;display:flex;gap:8px">
        <button id="checkoutBtn" class="cart-btn" style="flex:1">Checkout</button>
        <button id="clearBtn" style="background:#ef4444;color:#fff;border:0;padding:8px;border-radius:8px">Clear</button>
      </div>
      <div class="small" style="margin-top:10px">Orders auto-send to supplier after payment</div>
    </div>
  </aside>
</div>

<!-- Checkout Modal & Success Page remain unchanged -->
<!-- ... your existing modal & success HTML ... -->

<script>
(async function(){
  const API='/api';
  const stripe=Stripe(window.__STRIPE_PK||'pk_test_replace');
  let elements, card, cardMounted=false;
  let PRODUCTS=[], cart=JSON.parse(localStorage.getItem('ds_cart')||'[]');

  const productsGrid=document.getElementById('productsGrid');
  const upsellList=document.getElementById('upsellList');
  const cartList=document.getElementById('cartList');
  const cartTotal=document.getElementById('cartTotal');
  const cartCount=document.getElementById('cartCount');
  const checkoutBtn=document.getElementById('checkoutBtn');
  const clearBtn=document.getElementById('clearBtn');
  const checkoutModal=document.getElementById('checkoutModal');
  const placePayBtn=document.getElementById('placePayBtn');
  const cancelCheckout=document.getElementById('cancelCheckout');
  const paymentMethod=document.getElementById('paymentMethod');
  const stripeContainer=document.getElementById('stripeContainer');
  const paypalContainer=document.getElementById('paypalContainer');

  const adminTitle=document.getElementById('adminTitle');
  const adminPrice=document.getElementById('adminPrice');
  const adminCost=document.getElementById('adminCost');
  const adminSKU=document.getElementById('adminSKU');
  const adminImg=document.getElementById('adminImg');
  const adminAliLink=document.getElementById('adminAliLink');
  const fetchAliBtn=document.getElementById('fetchAli');
  const addProductBtn=document.getElementById('addProductBtn');
  const adminStatus=document.getElementById('adminStatus');
  const adminPanelWrapper=document.getElementById('adminPanelWrapper');
  const adminAccessBtn=document.getElementById('adminAccessBtn');

  // Admin access button logic
  adminAccessBtn.addEventListener('click', ()=>{
    const pw = prompt('Enter admin password:');
    if(pw==='itismecharles'){
      adminPanelWrapper.style.display='block';
      alert('Welcome, admin!');
    } else {
      alert('Incorrect password');
    }
  });

  function saveCart(){ localStorage.setItem('ds_cart', JSON.stringify(cart)); renderCart(); }

  function renderCart(){
    cartList.innerHTML=''; let total=0, count=0;
    cart.forEach((i,index)=>{
      total+=i.price*i.quantity;
      count+=i.quantity;
      const profit=((i.price-(i.supplierCost||0))*i.quantity/100).toFixed(2);
      const row=document.createElement('div'); row.className='cart-item';
      row.innerHTML=`
        <div style="flex:1">
          ${i.title} <span class="small">(Profit: $${profit})</span><br>
          <button class="qty-btn" data-index="${index}" data-action="decrease">-</button>
          <span style="margin:0 6px">${i.quantity}</span>
          <button class="qty-btn" data-index="${index}" data-action="increase">+</button>
          <button class="remove-btn" data-index="${index}" style="margin-left:6px;">Remove</button>
        </div>
        <div>$${(i.price*i.quantity/100).toFixed(2)}</div>`;
      cartList.appendChild(row);
    });
    cartTotal.textContent=`$${(total/100).toFixed(2)}`;
    cartCount.textContent=count;

    document.querySelectorAll('.qty-btn').forEach(btn=>{
      btn.addEventListener('click', e=>{
        const idx=e.currentTarget.dataset.index;
        const action=e.currentTarget.dataset.action;
        if(action==='increase') cart[idx].quantity++;
        else if(action==='decrease'){ cart[idx].quantity--; if(cart[idx].quantity<1) cart.splice(idx,1); }
        saveCart();
      });
    });
    document.querySelectorAll('.remove-btn').forEach(btn=>{
      btn.addEventListener('click', e=>{ const idx=e.currentTarget.dataset.index; cart.splice(idx,1); saveCart(); });
    });
  }

  function renderProducts(){
    productsGrid.innerHTML='';
    PRODUCTS.forEach(p=>{
      const cardEl=document.createElement('div'); cardEl.className='card';
      cardEl.innerHTML=`<img src="${p.img}" alt="${p.title}"><h4>${p.title}</h4><div class="small">SKU: ${p.supplier_sku}</div>
      <div style="margin-top:8px;display:flex;justify-content:space-between;align-items:center">
        <div class="price">$${(p.price/100).toFixed(2)}</div>
        <button class="cart-btn" data-id="${p.id}">Add</button>
      </div>`;
      productsGrid.appendChild(cardEl);
    });
    document.querySelectorAll('.card .cart-btn').forEach(b=>b.addEventListener('click', e=>{
      const id=e.currentTarget.dataset.id;
      const prod = PRODUCTS.find(p=>p.id===id);
      const exist = cart.find(c=>c.id===id);
      if(exist) exist.quantity++; else cart.push({...prod, quantity:1});
      saveCart();
    }));
  }

  function renderUpsells(){
    upsellList.innerHTML='';
    PRODUCTS.slice(0,2).forEach(p=>{
      const el=document.createElement('div'); el.style.minWidth='120px';
      el.innerHTML=`<div style="text-align:center">
        <img src="${p.img}" style="width:100px;height:60px;object-fit:cover;border-radius:6px">
        <div class="small">${p.title}</div>
        <div style="font-weight:700">$${(p.price/100).toFixed(2)}</div>
      </div>`;
      upsellList.appendChild(el);
    });
  }

  clearBtn.addEventListener('click', ()=>{ cart=[]; saveCart(); });

  // ... rest of your checkout and admin logic remains unchanged ...
})();
</script>
</body>
</html>
